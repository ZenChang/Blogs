_strupr_s 和 _strlwr_s两个函数可以将字符串改为大写或者小写形式的字符串。


### CreateToolhelp32Snapshot

抓取指定进程的快照，可以是被这个进程使用的堆，模块或者线程。

语法

    ``` C++
    HANDLE WINAPI CreateToolhelp32Snapshot
    (
        _In_ DWORD dwFlags,
        _In_ DWORD th32ProcessID
    )
    ```

参数

dwFlags (in)

表示快照中包含的系统的一部分。这个参数可以是如下的一个或多个的组合。

TH32CS_INHERIT
    
    指示这个快照句柄是可以被继承的。
    
TH32CS_SNAPALL
    
    包含系统中的所有的进程和线程，以及th32ProcessID指定的堆和模块。
    
    相当于使用TH32CS_SNAPHEAPLIST | TH32CS_SNAPMODULE | TH32CS_SNAPPROCESS | TH32CS_SNAPTHREAD
    
TH32CS_SNAPHEAPLIST

    包含在快照中th32ProcessID指定的所有的堆。要枚举这些堆，参见Heap32ListFirst。
    
TH32CS_SNAPMODULE

    包含在快照中th32ProcessID指定的所有的模块。要枚举这些模块，参见Module32First。
    
    如果函数返回错误码 ERROR_BAD_LENGTH，重试函数，直至成功。
    
    对于64位windows：这个标志在32位进程中可以获取所有的32位模块，在64位进程中可以获取所有的64位模块。
    
    要想在64进程中获取所有32位模块，请使用TH32CS_SNAPMODULE32标志。
    
TH32CS_SNAPMODULE32

    此标志可以与TH32CS_SNAPMODULE或者TH32CS_SNAPALL一起使用。可以在64位进程中也可以获得32位的目标。
    
    如果函数返回错误码 ERROR_BAD_LENGTH，重试函数，直至成功。
    
TH32CS_SNAPPROCESS

    包括快照中所有的系统进程。要枚举这些进程，参见Process32First。
    
TH32CS_SNAPTHREAD

    包括快照中所有的系统线程。要枚举这些线程，参见Thread32First。
    
    为了确定属于特定进程的线程，当枚举线程的时候，
    
    将进程的ID号与THREADENTRY32结构体的th32OwnerProcessID成员进行比较。

th32ProcessID (in)

    指定快照中的进程的ID号。这个参数可以为0，此时表示当前进程。
    
    当TH32CS_SNAPHEAPLIST,TH32CS_SNAPMODuLE,TH32CS_SNAPMODULE32或者TH32CS_SNAPALL被指定时生效。
    
    否则，该参数被忽略，将自动表示使用所有进程标志。

    如何指定的进程时Idle进程，或者是CSRSS系列进程中的一个，这个函数将会失败，
    
    错误码为ERROR_ACCESS_DENIED，因为这些函数的访问限制阻止了用户级别的代码打开它们的操作。
    
    如果指定的进程是一个64位的进程，并且调用者是32位的进程，那么函数将会失败，错误码为ERROR_PARTIAL_COPY。
    
返回值

    如果函数成功，它返回打开的指定快照的句柄。
    
    如果函数失败，返回INVALID_HANDLE_VALUE。
    
    调用GetLastError函数可以获取错误信息。可能该错误码为ERROR_BAD_LENGTH。
    
备注

    这个函数返回的快照将会被其他tool help函数使用以获取更详细的结果。
    
    该快照的访问权限是只读。
    
    该快照句柄作为一个目标句柄，在有效的进程和线程中必须遵守相同的规则。
    
    要枚举所有进程的堆和模块状态，指定TH32CS_SNAPALL并且将th32ProcessID置为0。
    
    然后，对于快照中每个附加的进程，再次调用CreateToolhelp32Snapshot，并且
    
    指定新的进程ID以及指定TH32CS_SNAPHEAPLIST和TH32_SNAPMODULE的值。
    
    如果获取非当前进程的包含堆和模块的快照信息的话，可能会失败，原因很多。
    
    如果返回错误码是ERROR_BAD_LENGTH，那么再次调用。
    
    释放该快照句柄，使用CloseHandle。
    
    注意你可以在32或64位进程中使用QueryFullProcessImageName函数获取一个32位的可执行镜像。

示例

    
















